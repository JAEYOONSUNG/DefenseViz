% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/08_pipeline.R
\name{rmscan_pipeline}
\alias{rmscan_pipeline}
\title{RMscan Main Pipeline}
\usage{
rmscan_pipeline(
  input_file,
  output_dir = ".",
  compare_rebase = TRUE,
  search_motifs = TRUE,
  blast_min_identity = 0.1,
  blast_min_length = 50,
  max_operon_gap = 5000,
  max_intervening = 1,
  verbose = TRUE,
  save_intermediates = TRUE
)
}
\arguments{
\item{input_file}{Path to DNMB annotation file (Excel or CSV)}

\item{output_dir}{Output directory for results}

\item{compare_rebase}{Whether to run REBASE comparison}

\item{search_motifs}{Whether to search catalytic/TRD motifs}

\item{blast_min_identity}{Minimum BLAST identity for filtering (default 0.10 = 10\%)}

\item{blast_min_length}{Minimum alignment length for filtering (default 50)}

\item{max_operon_gap}{Maximum gap for operon detection}

\item{max_intervening}{Maximum intervening genes for operon}

\item{verbose}{Print progress messages}

\item{save_intermediates}{Save intermediate data to global environment for debugging}
}
\value{
List containing all analysis results
}
\description{
Main wrapper function for complete R-M system analysis

Executes the full RMscan analysis pipeline on DNMB data

Pipeline order:
\enumerate{
\item Load data & annotation analysis
\item Detect MTase (PFAM + keyword) - initial candidates
\item Detect REase (PFAM + keyword) - initial candidates
\item Operon (genome context) analysis
\item REBASE BLAST comparison
\item \strong{FILTER} - Remove low-quality BLAST matches (identity < 10\%, length < 50)
\item Create annotated tables (BLAST results + operon info, important cols first)
7b. Detect catalytic motifs (PDxDxK, DPPY, PxGxG, Walker, DEAD/DEAH, etc.)
\item TRD extraction (for filtered candidates)
\item Extract recognition sequences from REBASE
\item Create comprehensive summary table
\item Generate R-M type heatmap (blast_identity >= 50\%)
\item Export results (R-M_REBASE_analysis.xlsx)
}
}
